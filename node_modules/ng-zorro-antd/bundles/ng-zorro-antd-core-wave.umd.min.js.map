{"version":3,"sources":["ng://ng-zorro-antd/core/wave/nz-wave-renderer.ts","ng://ng-zorro-antd/core/wave/nz-wave.directive.ts","ng://ng-zorro-antd/core/wave/nz-wave.module.ts"],"names":["NzWaveRenderer","triggerElement","ngZone","insertExtraNode","_this","this","waveTransitionDuration","lastTime","platform","Platform","onClick","event","getAttribute","tagName","className","indexOf","fadeOutWave","clickHandler","bind","bindTriggerEvent","Object","defineProperty","prototype","isBrowser","runOutsideAngular","removeTriggerEvent","addEventListener","removeEventListener","removeStyleAndExtraNode","styleForPseudo","document","body","contains","removeChild","extraNode","destroy","node","waveColor","getWaveColor","setAttribute","waveAttributeName","Date","now","isValidColor","createElement","innerHTML","appendChild","runTimeoutOutsideZone","removeAttribute","color","isNotGrey","test","match","nodeStyle","getComputedStyle","getPropertyValue","fn","delay","setTimeout","NZ_WAVE_GLOBAL_DEFAULT_CONFIG","disabled","NZ_WAVE_GLOBAL_CONFIG","InjectionToken","providedIn","factory","NZ_WAVE_GLOBAL_CONFIG_FACTORY","NzWaveDirective","elementRef","config","animationType","nzWaveExtraNode","waveDisabled","isConfigDisabled","waveRenderer","ngOnDestroy","ngOnInit","renderWaveIfEnabled","nativeElement","disable","enable","Directive","args","selector","exportAs","NgZone","ElementRef","Optional","type","Inject","ANIMATION_MODULE_TYPE","Input","NzWaveModule","NgModule","imports","PlatformModule","exports","declarations"],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { Platform } from '@angular/cdk/platform';\nimport { NgZone } from '@angular/core';\n\nexport class NzWaveRenderer {\n  private waveTransitionDuration = 400;\n  private styleForPseudo: HTMLStyleElement | null;\n  private extraNode: HTMLDivElement | null;\n  private lastTime = 0;\n  private platform = new Platform();\n  clickHandler: () => void;\n  get waveAttributeName(): string {\n    return this.insertExtraNode ? 'ant-click-animating' : 'ant-click-animating-without-extra-node';\n  }\n\n  constructor(private triggerElement: HTMLElement, private ngZone: NgZone, private insertExtraNode: boolean) {\n    this.clickHandler = this.onClick.bind(this);\n    this.bindTriggerEvent();\n  }\n\n  onClick = (event: MouseEvent) => {\n    if (\n      !this.triggerElement ||\n      !this.triggerElement.getAttribute ||\n      this.triggerElement.getAttribute('disabled') ||\n      (event.target as HTMLElement).tagName === 'INPUT' ||\n      this.triggerElement.className.indexOf('disabled') >= 0\n    ) {\n      return;\n    }\n    this.fadeOutWave();\n  };\n\n  bindTriggerEvent(): void {\n    if (this.platform.isBrowser) {\n      this.ngZone.runOutsideAngular(() => {\n        this.removeTriggerEvent();\n        if (this.triggerElement) {\n          this.triggerElement.addEventListener('click', this.clickHandler, true);\n        }\n      });\n    }\n  }\n\n  removeTriggerEvent(): void {\n    if (this.triggerElement) {\n      this.triggerElement.removeEventListener('click', this.clickHandler, true);\n    }\n  }\n\n  removeStyleAndExtraNode(): void {\n    if (this.styleForPseudo && document.body.contains(this.styleForPseudo)) {\n      document.body.removeChild(this.styleForPseudo);\n      this.styleForPseudo = null;\n    }\n    if (this.insertExtraNode && this.triggerElement.contains(this.extraNode)) {\n      this.triggerElement.removeChild(this.extraNode as Node);\n    }\n  }\n\n  destroy(): void {\n    this.removeTriggerEvent();\n    this.removeStyleAndExtraNode();\n  }\n\n  private fadeOutWave(): void {\n    const node = this.triggerElement;\n    const waveColor = this.getWaveColor(node);\n    node.setAttribute(this.waveAttributeName, 'true');\n    if (Date.now() < this.lastTime + this.waveTransitionDuration) {\n      return;\n    }\n\n    if (this.isValidColor(waveColor)) {\n      if (!this.styleForPseudo) {\n        this.styleForPseudo = document.createElement('style');\n      }\n\n      this.styleForPseudo.innerHTML = `\n      [ant-click-animating-without-extra-node='true']::after, .ant-click-animating-node {\n        --antd-wave-shadow-color: ${waveColor};\n      }`;\n      document.body.appendChild(this.styleForPseudo);\n    }\n\n    if (this.insertExtraNode) {\n      if (!this.extraNode) {\n        this.extraNode = document.createElement('div');\n      }\n      this.extraNode.className = 'ant-click-animating-node';\n      node.appendChild(this.extraNode);\n    }\n\n    this.lastTime = Date.now();\n\n    this.runTimeoutOutsideZone(() => {\n      node.removeAttribute(this.waveAttributeName);\n      this.removeStyleAndExtraNode();\n    }, this.waveTransitionDuration);\n  }\n\n  private isValidColor(color: string): boolean {\n    return (\n      !!color &&\n      color !== '#ffffff' &&\n      color !== 'rgb(255, 255, 255)' &&\n      this.isNotGrey(color) &&\n      !/rgba\\(\\d*, \\d*, \\d*, 0\\)/.test(color) &&\n      color !== 'transparent'\n    );\n  }\n\n  private isNotGrey(color: string): boolean {\n    const match = color.match(/rgba?\\((\\d*), (\\d*), (\\d*)(, [\\.\\d]*)?\\)/);\n    if (match && match[1] && match[2] && match[3]) {\n      return !(match[1] === match[2] && match[2] === match[3]);\n    }\n    return true;\n  }\n\n  private getWaveColor(node: HTMLElement): string {\n    const nodeStyle = getComputedStyle(node);\n    return (\n      nodeStyle.getPropertyValue('border-top-color') || // Firefox Compatible\n      nodeStyle.getPropertyValue('border-color') ||\n      nodeStyle.getPropertyValue('background-color')\n    );\n  }\n\n  private runTimeoutOutsideZone(fn: () => void, delay: number): void {\n    this.ngZone.runOutsideAngular(() => setTimeout(fn, delay));\n  }\n}\n","/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { Directive, ElementRef, Inject, InjectionToken, Input, NgZone, OnDestroy, OnInit, Optional } from '@angular/core';\nimport { ANIMATION_MODULE_TYPE } from '@angular/platform-browser/animations';\nimport { NzWaveRenderer } from './nz-wave-renderer';\n\nexport interface NzWaveConfig {\n  disabled?: boolean;\n}\n\nexport const NZ_WAVE_GLOBAL_DEFAULT_CONFIG: NzWaveConfig = {\n  disabled: false\n};\n\nexport const NZ_WAVE_GLOBAL_CONFIG = new InjectionToken<NzWaveConfig>('nz-wave-global-options', {\n  providedIn: 'root',\n  factory: NZ_WAVE_GLOBAL_CONFIG_FACTORY\n});\n\nexport function NZ_WAVE_GLOBAL_CONFIG_FACTORY(): NzWaveConfig {\n  return NZ_WAVE_GLOBAL_DEFAULT_CONFIG;\n}\n\n@Directive({\n  selector: '[nz-wave],button[nz-button]',\n  exportAs: 'nzWave'\n})\nexport class NzWaveDirective implements OnInit, OnDestroy {\n  @Input() nzWaveExtraNode = false;\n\n  private waveRenderer: NzWaveRenderer;\n  private waveDisabled: boolean = false;\n\n  get disabled(): boolean {\n    return this.waveDisabled;\n  }\n\n  get rendererRef(): NzWaveRenderer {\n    return this.waveRenderer;\n  }\n\n  constructor(\n    private ngZone: NgZone,\n    private elementRef: ElementRef,\n    @Optional() @Inject(NZ_WAVE_GLOBAL_CONFIG) private config: NzWaveConfig,\n    @Optional() @Inject(ANIMATION_MODULE_TYPE) private animationType: string\n  ) {\n    this.waveDisabled = this.isConfigDisabled();\n  }\n\n  isConfigDisabled(): boolean {\n    let disabled = false;\n    if (this.config && typeof this.config.disabled === 'boolean') {\n      disabled = this.config.disabled;\n    }\n    if (this.animationType === 'NoopAnimations') {\n      disabled = true;\n    }\n    return disabled;\n  }\n\n  ngOnDestroy(): void {\n    if (this.waveRenderer) {\n      this.waveRenderer.destroy();\n    }\n  }\n\n  ngOnInit(): void {\n    this.renderWaveIfEnabled();\n  }\n\n  renderWaveIfEnabled(): void {\n    if (!this.waveDisabled && this.elementRef.nativeElement) {\n      this.waveRenderer = new NzWaveRenderer(this.elementRef.nativeElement, this.ngZone, this.nzWaveExtraNode);\n    }\n  }\n\n  disable(): void {\n    this.waveDisabled = true;\n    if (this.waveRenderer) {\n      this.waveRenderer.removeTriggerEvent();\n      this.waveRenderer.removeStyleAndExtraNode();\n    }\n  }\n\n  enable(): void {\n    // config priority\n    this.waveDisabled = this.isConfigDisabled() || false;\n    if (this.waveRenderer) {\n      this.waveRenderer.bindTriggerEvent();\n    }\n  }\n}\n","/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { PlatformModule } from '@angular/cdk/platform';\nimport { NgModule } from '@angular/core';\nimport { NzWaveDirective } from './nz-wave.directive';\n\n@NgModule({\n  imports: [PlatformModule],\n  exports: [NzWaveDirective],\n  declarations: [NzWaveDirective]\n})\nexport class NzWaveModule {}\n"]}