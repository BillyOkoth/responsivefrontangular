{"version":3,"file":"ng-zorro-antd-core-outlet.js","sources":["ng://ng-zorro-antd/core/outlet/string_template_outlet.directive.ts","ng://ng-zorro-antd/core/outlet/outlet.module.ts"],"sourcesContent":["/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { Directive, EmbeddedViewRef, Input, OnChanges, SimpleChange, SimpleChanges, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { NzSafeAny } from 'ng-zorro-antd/core/types';\n\n@Directive({\n  selector: '[nzStringTemplateOutlet]',\n  exportAs: 'nzStringTemplateOutlet'\n})\nexport class NzStringTemplateOutletDirective implements OnChanges {\n  private embeddedViewRef: EmbeddedViewRef<NzSafeAny> | null = null;\n  @Input() nzStringTemplateOutletContext: NzSafeAny | null = null;\n  @Input() nzStringTemplateOutlet: string | TemplateRef<NzSafeAny> | null = null;\n\n  private recreateView(): void {\n    this.viewContainer.clear();\n    const isTemplateRef = this.nzStringTemplateOutlet instanceof TemplateRef;\n    const templateRef = (isTemplateRef ? this.nzStringTemplateOutlet : this.templateRef) as NzSafeAny;\n    this.embeddedViewRef = this.viewContainer.createEmbeddedView(templateRef, this.nzStringTemplateOutletContext);\n  }\n\n  private updateContext(): void {\n    const newCtx = this.nzStringTemplateOutletContext;\n    const oldCtx = this.embeddedViewRef!.context as NzSafeAny;\n    if (newCtx) {\n      for (const propName of Object.keys(newCtx)) {\n        oldCtx[propName] = newCtx[propName];\n      }\n    }\n  }\n\n  constructor(private viewContainer: ViewContainerRef, private templateRef: TemplateRef<NzSafeAny>) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    const shouldRecreateView = (ctxChanges: SimpleChanges): boolean => {\n      const { nzStringTemplateOutletContext, nzStringTemplateOutlet } = ctxChanges;\n      let shouldOutletRecreate = false;\n      if (nzStringTemplateOutlet) {\n        if (nzStringTemplateOutlet.firstChange) {\n          shouldOutletRecreate = true;\n        } else {\n          const isPreviousOutletTemplate = nzStringTemplateOutlet.previousValue instanceof TemplateRef;\n          const isCurrentOutletTemplate = nzStringTemplateOutlet.currentValue instanceof TemplateRef;\n          shouldOutletRecreate = isPreviousOutletTemplate || isCurrentOutletTemplate;\n        }\n      }\n      const hasContextShapeChanged = (ctxChange: SimpleChange): boolean => {\n        const prevCtxKeys = Object.keys(ctxChange.previousValue || {});\n        const currCtxKeys = Object.keys(ctxChange.currentValue || {});\n        if (prevCtxKeys.length === currCtxKeys.length) {\n          for (const propName of currCtxKeys) {\n            if (prevCtxKeys.indexOf(propName) === -1) {\n              return true;\n            }\n          }\n          return false;\n        } else {\n          return true;\n        }\n      };\n      const shouldContextRecreate = nzStringTemplateOutletContext && hasContextShapeChanged(nzStringTemplateOutletContext);\n      return shouldContextRecreate || shouldOutletRecreate;\n    };\n    const recreateView = shouldRecreateView(changes);\n    if (recreateView) {\n      /** recreate view when context shape or outlet change **/\n      this.recreateView();\n    } else {\n      /** update context **/\n      this.updateContext();\n    }\n  }\n}\n","/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { NzStringTemplateOutletDirective } from './string_template_outlet.directive';\n\n@NgModule({\n  imports: [CommonModule],\n  exports: [NzStringTemplateOutletDirective],\n  declarations: [NzStringTemplateOutletDirective]\n})\nexport class NzOutletModule {}\n"],"names":[],"mappings":"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"}