{"version":3,"file":"ng-zorro-antd-avatar.js","sources":["ng://ng-zorro-antd/avatar/avatar.component.ts","ng://ng-zorro-antd/avatar/avatar.module.ts"],"sourcesContent":["/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { Platform } from '@angular/cdk/platform';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  OnChanges,\n  Output,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\n\nimport { NzConfigService, WithConfig } from 'ng-zorro-antd/core/config';\nimport { NzShapeSCType, NzSizeLDSType } from 'ng-zorro-antd/core/types';\n\nconst NZ_CONFIG_COMPONENT_NAME = 'avatar';\n\n@Component({\n  selector: 'nz-avatar',\n  exportAs: 'nzAvatar',\n  template: `\n    <i nz-icon *ngIf=\"nzIcon && hasIcon\" [nzType]=\"nzIcon\"></i>\n    <img *ngIf=\"nzSrc && hasSrc\" [src]=\"nzSrc\" [attr.srcset]=\"nzSrcSet\" [attr.alt]=\"nzAlt\" (error)=\"imgError($event)\" />\n    <span class=\"ant-avatar-string\" #textEl [ngStyle]=\"textStyles\" *ngIf=\"nzText && hasText\">{{ nzText }}</span>\n  `,\n  host: {\n    '[class.ant-avatar]': 'true',\n    '[class.ant-avatar-lg]': `nzSize === 'large'`,\n    '[class.ant-avatar-sm]': `nzSize === 'small'`,\n    '[class.ant-avatar-square]': `nzShape === 'square'`,\n    '[class.ant-avatar-circle]': `nzShape === 'circle'`,\n    '[class.ant-avatar-icon]': `nzIcon`,\n    '[class.ant-avatar-image]': `hasSrc `,\n    '[style.width]': 'customSize',\n    '[style.height]': 'customSize',\n    '[style.line-height]': 'customSize',\n    '[style.font-size]': '(hasIcon && customSize) ? (nzSize / 2 + \"px\") : null'\n  },\n  preserveWhitespaces: false,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class NzAvatarComponent implements OnChanges {\n  @Input() @WithConfig(NZ_CONFIG_COMPONENT_NAME, 'circle') nzShape: NzShapeSCType;\n  @Input() @WithConfig(NZ_CONFIG_COMPONENT_NAME, 'default') nzSize: NzSizeLDSType | number;\n  @Input() nzText: string;\n  @Input() nzSrc: string;\n  @Input() nzSrcSet: string;\n  @Input() nzAlt: string;\n  @Input() nzIcon: string;\n  @Output() readonly nzError = new EventEmitter<Event>();\n\n  hasText: boolean = false;\n  hasSrc: boolean = true;\n  hasIcon: boolean = false;\n  textStyles: {};\n  customSize: string | null = null;\n\n  @ViewChild('textEl', { static: false }) textEl: ElementRef;\n\n  private el: HTMLElement = this.elementRef.nativeElement;\n\n  constructor(\n    public nzConfigService: NzConfigService,\n    private elementRef: ElementRef,\n    private cdr: ChangeDetectorRef,\n    private platform: Platform\n  ) {}\n\n  imgError($event: Event): void {\n    this.nzError.emit($event);\n    if (!$event.defaultPrevented) {\n      this.hasSrc = false;\n      this.hasIcon = false;\n      this.hasText = false;\n      if (this.nzIcon) {\n        this.hasIcon = true;\n      } else if (this.nzText) {\n        this.hasText = true;\n      }\n      this.cdr.detectChanges();\n      this.setSizeStyle();\n      this.notifyCalc();\n    }\n  }\n\n  ngOnChanges(): void {\n    this.hasText = !this.nzSrc && !!this.nzText;\n    this.hasIcon = !this.nzSrc && !!this.nzIcon;\n    this.hasSrc = !!this.nzSrc;\n\n    this.setSizeStyle();\n    this.notifyCalc();\n  }\n\n  private calcStringSize(): void {\n    if (!this.hasText) {\n      return;\n    }\n\n    const childrenWidth = this.textEl.nativeElement.offsetWidth;\n    const avatarWidth = this.el.getBoundingClientRect().width;\n    const scale = avatarWidth - 8 < childrenWidth ? (avatarWidth - 8) / childrenWidth : 1;\n    this.textStyles = {\n      transform: `scale(${scale}) translateX(-50%)`\n    };\n    if (this.customSize) {\n      Object.assign(this.textStyles, {\n        lineHeight: this.customSize\n      });\n    }\n    this.cdr.detectChanges();\n  }\n\n  private notifyCalc(): void {\n    // If use ngAfterViewChecked, always demands more computations, so......\n    if (this.platform.isBrowser) {\n      setTimeout(() => {\n        this.calcStringSize();\n      });\n    }\n  }\n\n  private setSizeStyle(): void {\n    if (typeof this.nzSize === 'number') {\n      this.customSize = `${this.nzSize}px`;\n    } else {\n      this.customSize = null;\n    }\n    this.cdr.markForCheck();\n  }\n}\n","/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\nimport { PlatformModule } from '@angular/cdk/platform';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { NzIconModule } from 'ng-zorro-antd/icon';\n\nimport { NzAvatarComponent } from './avatar.component';\n\n@NgModule({\n  declarations: [NzAvatarComponent],\n  exports: [NzAvatarComponent],\n  imports: [CommonModule, NzIconModule, PlatformModule]\n})\nexport class NzAvatarModule {}\n"],"names":[],"mappings":"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"}