/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { AbstractControlUtil } from './../abstract-control-util';
// tslint:disable-next-line:variable-name
var 
// tslint:disable-next-line:variable-name
PasswordValidators = /** @class */ (function () {
    function PasswordValidators() {
    }
    /**
     * @param {?} repeatCount
     * @return {?}
     */
    PasswordValidators.repeatCharacterRegexRule = /**
     * @param {?} repeatCount
     * @return {?}
     */
    function (repeatCount) {
        /** @type {?} */
        var validator = function (control) {
            if (AbstractControlUtil.isNotPresent(control))
                return undefined;
            /** @type {?} */
            var repeatDec = repeatCount - 1;
            /** @type {?} */
            var pattern = '([^\\x00-\\x1F])\\1{' + repeatDec + '}';
            if (control.value !== '' && new RegExp(pattern).test(control.value)) {
                return { 'repeatCharacterRegexRule': { 'repeatCount': repeatCount } };
            }
            return undefined;
        };
        return validator;
    };
    ;
    /**
     * @param {?} allowedChars
     * @return {?}
     */
    PasswordValidators.allowedCharacterRule = /**
     * @param {?} allowedChars
     * @return {?}
     */
    function (allowedChars) {
        /** @type {?} */
        var validator = function (control) {
            var e_1, _a;
            if (AbstractControlUtil.isNotPresent(control))
                return undefined;
            /** @type {?} */
            var value = control.value;
            /** @type {?} */
            var valid = true;
            /** @type {?} */
            var invalidChars = [];
            try {
                for (var value_1 = tslib_1.__values(value), value_1_1 = value_1.next(); !value_1_1.done; value_1_1 = value_1.next()) {
                    var char = value_1_1.value;
                    if (allowedChars.indexOf(char) === -1) {
                        valid = false;
                        if (invalidChars.indexOf(char) === -1) {
                            invalidChars.push(char);
                        }
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (value_1_1 && !value_1_1.done && (_a = value_1.return)) _a.call(value_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (!valid) {
                return { 'allowedCharacterRule': { 'invalidChars': invalidChars, 'allowedChars': allowedChars } };
            }
            return undefined;
        };
        return validator;
    };
    ;
    /**
     * @param {?} amount
     * @return {?}
     */
    PasswordValidators.alphabeticalCharacterRule = /**
     * @param {?} amount
     * @return {?}
     */
    function (amount) {
        /** @type {?} */
        var validator = function (control) {
            if (AbstractControlUtil.isNotPresent(control))
                return undefined;
            /** @type {?} */
            var value = control.value;
            if (value.length === 0) {
                return undefined;
            }
            /** @type {?} */
            var pattern = /[^A-Za-z]+/g;
            /** @type {?} */
            var stripped = value.replace(pattern, '');
            if (stripped.length < amount) {
                return { 'alphabeticalCharacterRule': { 'required': amount, 'actual': stripped.length } };
            }
            return undefined;
        };
        return validator;
    };
    ;
    /**
     * @param {?} amount
     * @return {?}
     */
    PasswordValidators.digitCharacterRule = /**
     * @param {?} amount
     * @return {?}
     */
    function (amount) {
        /** @type {?} */
        var validator = function (control) {
            if (AbstractControlUtil.isNotPresent(control))
                return undefined;
            /** @type {?} */
            var value = control.value;
            if (value.length === 0) {
                return undefined;
            }
            /** @type {?} */
            var pattern = /[^0-9\.]+/g;
            /** @type {?} */
            var stripped = value.replace(pattern, '');
            if (stripped.length < amount) {
                return { 'digitCharacterRule': { 'required': amount, 'actual': stripped.length } };
            }
            return undefined;
        };
        return validator;
    };
    ;
    /**
     * @param {?} amount
     * @return {?}
     */
    PasswordValidators.lowercaseCharacterRule = /**
     * @param {?} amount
     * @return {?}
     */
    function (amount) {
        /** @type {?} */
        var validator = function (control) {
            if (AbstractControlUtil.isNotPresent(control))
                return undefined;
            /** @type {?} */
            var value = control.value;
            if (value.length === 0) {
                return undefined;
            }
            /** @type {?} */
            var pattern = /[^a-z]+/g;
            /** @type {?} */
            var stripped = value.replace(pattern, '');
            if (stripped.length < amount) {
                return { 'lowercaseCharacterRule': { 'required': amount, 'actual': stripped.length } };
            }
            return undefined;
        };
        return validator;
    };
    ;
    /**
     * @param {?} amount
     * @return {?}
     */
    PasswordValidators.uppercaseCharacterRule = /**
     * @param {?} amount
     * @return {?}
     */
    function (amount) {
        /** @type {?} */
        var validator = function (control) {
            if (AbstractControlUtil.isNotPresent(control))
                return undefined;
            /** @type {?} */
            var value = control.value;
            if (value.length === 0) {
                return undefined;
            }
            /** @type {?} */
            var pattern = /[^A-Z]+/g;
            /** @type {?} */
            var stripped = value.replace(pattern, '');
            if (stripped.length < amount) {
                return { 'uppercaseCharacterRule': { 'required': amount, 'actual': stripped.length } };
            }
            return undefined;
        };
        return validator;
    };
    ;
    /**
     * @param {?} amount
     * @return {?}
     */
    PasswordValidators.specialCharacterRule = /**
     * @param {?} amount
     * @return {?}
     */
    function (amount) {
        /** @type {?} */
        var validator = function (control) {
            if (AbstractControlUtil.isNotPresent(control))
                return undefined;
            /** @type {?} */
            var value = control.value;
            if (value.length === 0) {
                return undefined;
            }
            /** @type {?} */
            var pattern = /[\w\s]+/g;
            /** @type {?} */
            var stripped = value.replace(pattern, '');
            if (stripped.length < amount) {
                return { 'specialCharacterRule': { 'required': amount, 'actual': stripped.length } };
            }
            return undefined;
        };
        return validator;
    };
    ;
    /**
     * @param {?=} passwordControlName
     * @param {?=} confirmPasswordControlName
     * @return {?}
     */
    PasswordValidators.mismatchedPasswords = /**
     * @param {?=} passwordControlName
     * @param {?=} confirmPasswordControlName
     * @return {?}
     */
    function (passwordControlName, confirmPasswordControlName) {
        /** @type {?} */
        var validator = function (group) {
            /** @type {?} */
            var newPasswordValue = group.get(passwordControlName ? passwordControlName : 'newPassword').value;
            /** @type {?} */
            var newPasswordConfirmValue = group.get(confirmPasswordControlName ? confirmPasswordControlName : 'confirmPassword').value;
            if (newPasswordValue !== newPasswordConfirmValue) {
                AbstractControlUtil.addError(group.get(confirmPasswordControlName ? confirmPasswordControlName : 'confirmPassword'), 'mismatchedPasswords', true);
                return { 'mismatchedPasswords': true };
            }
            else {
                AbstractControlUtil.removeError(group.get(confirmPasswordControlName ? confirmPasswordControlName : 'confirmPassword'), 'mismatchedPasswords');
            }
            return undefined;
        };
        return validator;
    };
    ;
    return PasswordValidators;
}());
// tslint:disable-next-line:variable-name
export { PasswordValidators };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFzc3dvcmQtdmFsaWRhdG9ycy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC12YWxpZGF0b3JzLyIsInNvdXJjZXMiOlsiY29tcG9uZW50cy9wYXNzd29yZC9wYXNzd29yZC12YWxpZGF0b3JzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7O0FBR2pFOzs7SUFBQTtJQTRJQSxDQUFDOzs7OztJQTFJaUIsMkNBQXdCOzs7O0lBQXRDLFVBQXVDLFdBQW1COztZQUNoRCxTQUFTLEdBQUcsVUFBQyxPQUF3QjtZQUN2QyxJQUFJLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUM7Z0JBQUUsT0FBTyxTQUFTLENBQUM7O2dCQUM1RCxTQUFTLEdBQUcsV0FBVyxHQUFHLENBQUM7O2dCQUMzQixPQUFPLEdBQUcsc0JBQXNCLEdBQUcsU0FBUyxHQUFHLEdBQUc7WUFDdEQsSUFBSSxPQUFPLENBQUMsS0FBSyxLQUFLLEVBQUUsSUFBSSxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUNqRSxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsRUFBRSxhQUFhLEVBQUUsV0FBVyxFQUFFLEVBQUUsQ0FBQzthQUN6RTtZQUNELE9BQU8sU0FBUyxDQUFDO1FBQ3JCLENBQUM7UUFDRCxPQUFPLFNBQVMsQ0FBQztJQUNyQixDQUFDO0lBQUEsQ0FBQzs7Ozs7SUFFWSx1Q0FBb0I7Ozs7SUFBbEMsVUFBbUMsWUFBc0I7O1lBQy9DLFNBQVMsR0FBRyxVQUFDLE9BQXdCOztZQUN2QyxJQUFJLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUM7Z0JBQUUsT0FBTyxTQUFTLENBQUM7O2dCQUM1RCxLQUFLLEdBQVcsT0FBTyxDQUFDLEtBQUs7O2dCQUM3QixLQUFLLEdBQUcsSUFBSTs7Z0JBQ1osWUFBWSxHQUFhLEVBQUU7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YUFDMUM7aUJBQU07Z0JBQ0gsbUJBQW1CLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsMEJBQTBCLENBQUMsQ0FBQyxDQUFDLDBCQUEwQixDQUFDLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLHFCQUFxQixDQUFDLENBQUM7YUFDbEo7WUFDRCxPQUFPLFNBQVMsQ0FBQztRQUVyQixDQUFDO1FBQ0QsT0FBTyxTQUFTLENBQUM7SUFDckIsQ0FBQztJQUFBLENBQUM7SUFFTix5QkFBQztBQUFELENBQUMsQUE1SUQsSUE0SUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBYnN0cmFjdENvbnRyb2wsIFZhbGlkYXRvckZuIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgQWJzdHJhY3RDb250cm9sVXRpbCB9IGZyb20gJy4vLi4vYWJzdHJhY3QtY29udHJvbC11dGlsJztcblxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnZhcmlhYmxlLW5hbWVcbmV4cG9ydCBjbGFzcyBQYXNzd29yZFZhbGlkYXRvcnMge1xuXG4gICAgcHVibGljIHN0YXRpYyByZXBlYXRDaGFyYWN0ZXJSZWdleFJ1bGUocmVwZWF0Q291bnQ6IG51bWJlcikge1xuICAgICAgICBjb25zdCB2YWxpZGF0b3IgPSAoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSA9PiB7XG4gICAgICAgICAgICBpZiAoQWJzdHJhY3RDb250cm9sVXRpbC5pc05vdFByZXNlbnQoY29udHJvbCkpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICBsZXQgcmVwZWF0RGVjID0gcmVwZWF0Q291bnQgLSAxO1xuICAgICAgICAgICAgbGV0IHBhdHRlcm4gPSAnKFteXFxcXHgwMC1cXFxceDFGXSlcXFxcMXsnICsgcmVwZWF0RGVjICsgJ30nO1xuICAgICAgICAgICAgaWYgKGNvbnRyb2wudmFsdWUgIT09ICcnICYmIG5ldyBSZWdFeHAocGF0dGVybikudGVzdChjb250cm9sLnZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7ICdyZXBlYXRDaGFyYWN0ZXJSZWdleFJ1bGUnOiB7ICdyZXBlYXRDb3VudCc6IHJlcGVhdENvdW50IH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB2YWxpZGF0b3I7XG4gICAgfTtcblxuICAgIHB1YmxpYyBzdGF0aWMgYWxsb3dlZENoYXJhY3RlclJ1bGUoYWxsb3dlZENoYXJzOiBzdHJpbmdbXSk6IFZhbGlkYXRvckZuIHtcbiAgICAgICAgY29uc3QgdmFsaWRhdG9yID0gKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IHsgW2tleTogc3RyaW5nXTogYW55IH0gPT4ge1xuICAgICAgICAgICAgaWYgKEFic3RyYWN0Q29udHJvbFV0aWwuaXNOb3RQcmVzZW50KGNvbnRyb2wpKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgbGV0IHZhbHVlOiBzdHJpbmcgPSBjb250cm9sLnZhbHVlO1xuICAgICAgICAgICAgbGV0IHZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgIGxldCBpbnZhbGlkQ2hhcnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgICAgIGZvciAobGV0IGNoYXIgb2YgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWxsb3dlZENoYXJzLmluZGV4T2YoY2hhcikgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnZhbGlkQ2hhcnMuaW5kZXhPZihjaGFyKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGludmFsaWRDaGFycy5wdXNoKGNoYXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF2YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7ICdhbGxvd2VkQ2hhcmFjdGVyUnVsZSc6IHsgJ2ludmFsaWRDaGFycyc6IGludmFsaWRDaGFycywgJ2FsbG93ZWRDaGFycyc6IGFsbG93ZWRDaGFycyB9IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdmFsaWRhdG9yO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIGFscGhhYmV0aWNhbENoYXJhY3RlclJ1bGUoYW1vdW50OiBudW1iZXIpOiBWYWxpZGF0b3JGbiB7XG4gICAgICAgIGNvbnN0IHZhbGlkYXRvciA9IChjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0+IHtcbiAgICAgICAgICAgIGlmIChBYnN0cmFjdENvbnRyb2xVdGlsLmlzTm90UHJlc2VudChjb250cm9sKSkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGxldCB2YWx1ZTogc3RyaW5nID0gY29udHJvbC52YWx1ZTtcbiAgICAgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHBhdHRlcm4gPSAvW15BLVphLXpdKy9nO1xuICAgICAgICAgICAgbGV0IHN0cmlwcGVkID0gdmFsdWUucmVwbGFjZShwYXR0ZXJuLCAnJyk7XG4gICAgICAgICAgICBpZiAoc3RyaXBwZWQubGVuZ3RoIDwgYW1vdW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgJ2FscGhhYmV0aWNhbENoYXJhY3RlclJ1bGUnOiB7ICdyZXF1aXJlZCc6IGFtb3VudCwgJ2FjdHVhbCc6IHN0cmlwcGVkLmxlbmd0aCB9IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdmFsaWRhdG9yO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIGRpZ2l0Q2hhcmFjdGVyUnVsZShhbW91bnQ6IG51bWJlcik6IFZhbGlkYXRvckZuIHtcbiAgICAgICAgY29uc3QgdmFsaWRhdG9yID0gKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IHsgW2tleTogc3RyaW5nXTogYW55IH0gPT4ge1xuICAgICAgICAgICAgaWYgKEFic3RyYWN0Q29udHJvbFV0aWwuaXNOb3RQcmVzZW50KGNvbnRyb2wpKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgbGV0IHZhbHVlOiBzdHJpbmcgPSBjb250cm9sLnZhbHVlO1xuICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgcGF0dGVybiA9IC9bXjAtOVxcLl0rL2c7XG4gICAgICAgICAgICBsZXQgc3RyaXBwZWQgPSB2YWx1ZS5yZXBsYWNlKHBhdHRlcm4sICcnKTtcbiAgICAgICAgICAgIGlmIChzdHJpcHBlZC5sZW5ndGggPCBhbW91bnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyAnZGlnaXRDaGFyYWN0ZXJSdWxlJzogeyAncmVxdWlyZWQnOiBhbW91bnQsICdhY3R1YWwnOiBzdHJpcHBlZC5sZW5ndGggfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRvcjtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBsb3dlcmNhc2VDaGFyYWN0ZXJSdWxlKGFtb3VudDogbnVtYmVyKTogVmFsaWRhdG9yRm4ge1xuICAgICAgICBjb25zdCB2YWxpZGF0b3IgPSAoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSA9PiB7XG4gICAgICAgICAgICBpZiAoQWJzdHJhY3RDb250cm9sVXRpbC5pc05vdFByZXNlbnQoY29udHJvbCkpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICBsZXQgdmFsdWU6IHN0cmluZyA9IGNvbnRyb2wudmFsdWU7XG4gICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBwYXR0ZXJuID0gL1teYS16XSsvZztcbiAgICAgICAgICAgIGxldCBzdHJpcHBlZCA9IHZhbHVlLnJlcGxhY2UocGF0dGVybiwgJycpO1xuICAgICAgICAgICAgaWYgKHN0cmlwcGVkLmxlbmd0aCA8IGFtb3VudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7ICdsb3dlcmNhc2VDaGFyYWN0ZXJSdWxlJzogeyAncmVxdWlyZWQnOiBhbW91bnQsICdhY3R1YWwnOiBzdHJpcHBlZC5sZW5ndGggfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRvcjtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyB1cHBlcmNhc2VDaGFyYWN0ZXJSdWxlKGFtb3VudDogbnVtYmVyKTogVmFsaWRhdG9yRm4ge1xuICAgICAgICBjb25zdCB2YWxpZGF0b3IgPSAoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSA9PiB7XG4gICAgICAgICAgICBpZiAoQWJzdHJhY3RDb250cm9sVXRpbC5pc05vdFByZXNlbnQoY29udHJvbCkpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICBsZXQgdmFsdWU6IHN0cmluZyA9IGNvbnRyb2wudmFsdWU7XG4gICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBwYXR0ZXJuID0gL1teQS1aXSsvZztcbiAgICAgICAgICAgIGxldCBzdHJpcHBlZCA9IHZhbHVlLnJlcGxhY2UocGF0dGVybiwgJycpO1xuICAgICAgICAgICAgaWYgKHN0cmlwcGVkLmxlbmd0aCA8IGFtb3VudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7ICd1cHBlcmNhc2VDaGFyYWN0ZXJSdWxlJzogeyAncmVxdWlyZWQnOiBhbW91bnQsICdhY3R1YWwnOiBzdHJpcHBlZC5sZW5ndGggfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRvcjtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBzcGVjaWFsQ2hhcmFjdGVyUnVsZShhbW91bnQ6IG51bWJlcik6IFZhbGlkYXRvckZuIHtcbiAgICAgICAgY29uc3QgdmFsaWRhdG9yID0gKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IHsgW2tleTogc3RyaW5nXTogYW55IH0gPT4ge1xuICAgICAgICAgICAgaWYgKEFic3RyYWN0Q29udHJvbFV0aWwuaXNOb3RQcmVzZW50KGNvbnRyb2wpKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgbGV0IHZhbHVlOiBzdHJpbmcgPSBjb250cm9sLnZhbHVlO1xuICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgcGF0dGVybiA9IC9bXFx3XFxzXSsvZztcbiAgICAgICAgICAgIGxldCBzdHJpcHBlZCA9IHZhbHVlLnJlcGxhY2UocGF0dGVybiwgJycpO1xuICAgICAgICAgICAgaWYgKHN0cmlwcGVkLmxlbmd0aCA8IGFtb3VudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7ICdzcGVjaWFsQ2hhcmFjdGVyUnVsZSc6IHsgJ3JlcXVpcmVkJzogYW1vdW50LCAnYWN0dWFsJzogc3RyaXBwZWQubGVuZ3RoIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB2YWxpZGF0b3I7XG4gICAgfTtcblxuICAgIHB1YmxpYyBzdGF0aWMgbWlzbWF0Y2hlZFBhc3N3b3JkcyhwYXNzd29yZENvbnRyb2xOYW1lPzogc3RyaW5nLCBjb25maXJtUGFzc3dvcmRDb250cm9sTmFtZT86IHN0cmluZyk6IFZhbGlkYXRvckZuIHtcbiAgICAgICAgY29uc3QgdmFsaWRhdG9yID0gKGdyb3VwOiBBYnN0cmFjdENvbnRyb2wpOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0+IHtcbiAgICAgICAgICAgIGxldCBuZXdQYXNzd29yZFZhbHVlID0gZ3JvdXAuZ2V0KHBhc3N3b3JkQ29udHJvbE5hbWUgPyBwYXNzd29yZENvbnRyb2xOYW1lIDogJ25ld1Bhc3N3b3JkJykudmFsdWU7XG4gICAgICAgICAgICBsZXQgbmV3UGFzc3dvcmRDb25maXJtVmFsdWUgPSBncm91cC5nZXQoY29uZmlybVBhc3N3b3JkQ29udHJvbE5hbWUgPyBjb25maXJtUGFzc3dvcmRDb250cm9sTmFtZSA6ICdjb25maXJtUGFzc3dvcmQnKS52YWx1ZTtcbiAgICAgICAgICAgIGlmIChuZXdQYXNzd29yZFZhbHVlICE9PSBuZXdQYXNzd29yZENvbmZpcm1WYWx1ZSkge1xuICAgICAgICAgICAgICAgIEFic3RyYWN0Q29udHJvbFV0aWwuYWRkRXJyb3IoZ3JvdXAuZ2V0KGNvbmZpcm1QYXNzd29yZENvbnRyb2xOYW1lID8gY29uZmlybVBhc3N3b3JkQ29udHJvbE5hbWUgOiAnY29uZmlybVBhc3N3b3JkJyksICdtaXNtYXRjaGVkUGFzc3dvcmRzJywgdHJ1ZSlcblxuICAgICAgICAgICAgICAgIHJldHVybiB7ICdtaXNtYXRjaGVkUGFzc3dvcmRzJzogdHJ1ZSB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBBYnN0cmFjdENvbnRyb2xVdGlsLnJlbW92ZUVycm9yKGdyb3VwLmdldChjb25maXJtUGFzc3dvcmRDb250cm9sTmFtZSA/IGNvbmZpcm1QYXNzd29yZENvbnRyb2xOYW1lIDogJ2NvbmZpcm1QYXNzd29yZCcpLCAnbWlzbWF0Y2hlZFBhc3N3b3JkcycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcblxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdmFsaWRhdG9yO1xuICAgIH07XG5cbn1cbiJdfQ==